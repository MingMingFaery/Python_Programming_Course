{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 第二题\n",
    "- 假设您是某商场的管理者，在月末需要分析该商场的经营情况。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pymysql\n",
    "db = pymysql.connect(host='localhost',\n",
    "                     user='root',\n",
    "                     password='password',\n",
    "                     port=3306\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(('new_table',), ('order_1',), ('order_info',), ('orders',))\n"
     ]
    }
   ],
   "source": [
    "# （1）建立一个数据库命名为 supermarket；\n",
    "cursor = db.cursor()\n",
    "cursor.execute(\"CREATE DATABASE IF NOT EXISTS supermarket\")\n",
    "cursor.execute(\"USE supermarket;\")\n",
    "cursor.execute(\"SHOW TABLES;\")\n",
    "data = cursor.fetchall()\n",
    "print(data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# （2）在数据库supermarket中建立一个表order存储订单数据\n",
    "cursor = db.cursor()\n",
    "cursor.execute(\"CREATE TABLE IF NOT EXISTS orders(id varchar(20),sku varchar(15),server varchar(15),stime varchar(15),num int,unit_price float,total_price float)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "#（3）读取Demo_1.txt 中的数据，将数据插入到表order中。\n",
    "with open(\"./Demo_1.txt\") as f:\n",
    "    temp = f.readlines()\n",
    "sqls = []\n",
    "for line in temp:\n",
    "    line = line.strip().split(\" \")\n",
    "    if len(line)!=7:\n",
    "        print(line)\n",
    "        continue\n",
    "    line[-3] = int(line[-3])\n",
    "    line[-2] = float(line[-2])\n",
    "    line[-1] = float(line[-1])\n",
    "    ss = f\"INSERT INTO orders(id,sku,server,stime,num,unit_price,total_price)VALUES('{line[0]}','{line[1]}','{line[2]}','{line[3]}',{line[4]},{line[5]},{line[6]});\"\n",
    "    sqls.append(ss)\n",
    "cursor = db.cursor()\n",
    "for sql in sqls:\n",
    "    cursor.execute(sql)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "sku         |unit_price  |\n",
      "---------------------------------\n",
      "10531743    |     303.03 |\n",
      "10531743    |      336.7 |\n",
      "10531743    |     303.03 |\n",
      "10531743    |     303.03 |\n",
      "10502625    |     330.35 |\n",
      "10502625    |     330.35 |\n",
      "10558863    |     325.13 |\n",
      "10584081    |     315.49 |\n",
      "10528445    |     302.24 |\n",
      "10531743    |     303.03 |\n",
      "10528445    |     302.24 |\n",
      "10584081    |     315.49 |\n",
      "10531743    |      336.7 |\n"
     ]
    }
   ],
   "source": [
    "#（4）使用SQL语句从order表中提取单价在200元以上商品的sku和单价；\n",
    "def read_sql(sql):\n",
    "    cursor = db.cursor(pymysql.cursors.DictCursor)\n",
    "    a = cursor.execute(sql)\n",
    "    if a==1:\n",
    "        data = cursor.fetchall()\n",
    "        print(data)\n",
    "    elif a>1:\n",
    "        data = cursor.fetchall()\n",
    "        for line in data[0].keys():\n",
    "            if len(str(data[0][line]))>10:\n",
    "                print(\"{:17} |\".format(line),end=\"\") \n",
    "            else:\n",
    "                print(\"{:11} |\".format(line),end=\"\") \n",
    "        print(\"\\n---------------------------------\")\n",
    "        for line in data:\n",
    "            for attr in line.values():\n",
    "                if len(str(attr))>10:\n",
    "                    print(\"{:17} |\".format(attr),end=\"\") \n",
    "                else:\n",
    "                    print(\"{:11} |\".format(attr),end=\"\") \n",
    "            print()\n",
    "read_sql(\"\"\"SELECT sku,unit_price FROM orders WHERE unit_price>300 \"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "id                |tprice      |total_num   |\n",
      "---------------------------------\n",
      "2024100100000000  |     149.36 |          1 |\n",
      "2024100101000001  |     304.95 |          2 |\n",
      "2024100101000002  |     913.52 |          6 |\n",
      "2024100101000003  |     364.44 |          2 |\n",
      "2024100100000004  |     126.71 |          1 |\n",
      "2024100100000005  |     862.46 |          4 |\n",
      "2024100101000006  |     166.06 |          1 |\n",
      "2024100100000007  |     306.81 |          2 |\n",
      "2024100100000008  |      320.7 |          3 |\n",
      "2024100100000009  |     212.47 |          1 |\n",
      "2024100100000010  |     512.42 |          3 |\n",
      "2024100100000011  |     298.48 |          2 |\n",
      "2024100100000012  |     275.08 |          2 |\n",
      "2024100100000013  |     422.94 |          3 |\n",
      "2024100101000014  |      89.67 |          1 |\n",
      "2024100100000015  |     104.55 |          1 |\n",
      "2024100101000016  |     819.55 |          5 |\n",
      "2024100101000017  |     241.36 |          2 |\n",
      "2024100100000018  |     247.93 |          2 |\n",
      "2024100100000019  |     194.21 |          1 |\n",
      "2024100100000020  |      194.7 |          1 |\n",
      "2024100101000021  |     479.72 |          3 |\n",
      "2024100100000022  |     410.36 |          2 |\n",
      "2024100100000023  |     647.37 |          3 |\n",
      "2024100100000024  |     933.59 |          7 |\n",
      "2024100200000000  |     387.22 |          2 |\n",
      "2024100200000001  |    1817.57 |          9 |\n",
      "2024100200000002  |     615.87 |          3 |\n",
      "2024100200000003  |      213.8 |          2 |\n",
      "2024100200000004  |      431.9 |          3 |\n",
      "2024100200000005  |      94.19 |          1 |\n",
      "2024100200000006  |     419.67 |          2 |\n",
      "2024100200000007  |      762.3 |          5 |\n",
      "2024100200000008  |    1456.81 |          9 |\n",
      "2024100200000009  |    1210.23 |          7 |\n",
      "2024100200000010  |     305.65 |          2 |\n",
      "2024100200000011  |     453.28 |          3 |\n",
      "2024100200000012  |    1288.59 |          9 |\n",
      "2024100200000013  |     383.26 |          2 |\n",
      "2024100200000014  |     543.39 |          4 |\n",
      "2024100200000015  |     148.11 |          1 |\n",
      "2024100200000016  |      276.1 |          2 |\n",
      "2024100200000017  |      445.3 |          3 |\n",
      "2024100200000018  |    1151.08 |          7 |\n",
      "2024100200000019  |     155.35 |          1 |\n",
      "2024100201000020  |     218.39 |          2 |\n",
      "2024100201000021  |     259.51 |          2 |\n",
      "2024100201000022  |     192.09 |          1 |\n",
      "2024100200000023  |     394.99 |          3 |\n",
      "2024100200000024  |     139.95 |          1 |\n",
      "2024100201000025  |     200.38 |          1 |\n",
      "2024100200000026  |    1086.52 |          8 |\n",
      "2024100201000027  |      453.6 |          3 |\n",
      "2024100201000028  |     346.81 |          3 |\n",
      "2024100200000029  |     785.94 |          4 |\n",
      "2024100300000000  |     359.65 |          2 |\n",
      "2024100301000001  |     281.85 |          2 |\n",
      "2024100301000002  |     253.87 |          2 |\n",
      "2024100300000003  |      261.6 |          2 |\n",
      "2024100300000004  |     189.26 |          1 |\n",
      "2024100301000005  |     132.66 |          1 |\n",
      "2024100300000006  |    1431.36 |          8 |\n",
      "2024100300000007  |     333.83 |          2 |\n",
      "2024100300000008  |    1136.64 |          7 |\n",
      "2024100300000009  |     545.91 |          3 |\n",
      "2024100301000010  |     266.98 |          2 |\n",
      "2024100300000011  |     300.34 |          2 |\n",
      "2024100301000012  |     462.59 |          3 |\n",
      "2024100301000013  |     287.37 |          3 |\n",
      "2024100300000014  |     556.33 |          4 |\n",
      "2024100301000015  |     240.67 |          2 |\n",
      "2024100301000016  |     224.92 |          2 |\n",
      "2024100300000017  |     322.19 |          2 |\n",
      "2024100300000018  |     515.58 |          4 |\n",
      "2024100300000019  |     154.68 |          1 |\n",
      "2024100301000020  |     188.73 |          1 |\n",
      "2024100300000021  |     345.02 |          3 |\n",
      "2024100300000022  |     537.33 |          2 |\n",
      "2024100300000023  |     311.42 |          3 |\n",
      "2024100300000024  |     388.82 |          3 |\n",
      "2024100301000025  |      680.8 |          3 |\n",
      "2024100300000026  |    1318.98 |          8 |\n",
      "2024100300000027  |     461.53 |          3 |\n",
      "2024100300000028  |     378.85 |          2 |\n",
      "2024100300000029  |     706.08 |          4 |\n",
      "2024100300000030  |      86.43 |          1 |\n",
      "2024100300000031  |     821.12 |          5 |\n",
      "2024100300000032  |     270.23 |          2 |\n",
      "2024100300000033  |     161.54 |          1 |\n",
      "2024100300000034  |     282.74 |          2 |\n",
      "2024100301000035  |      641.8 |          3 |\n",
      "2024100300000036  |     143.27 |          1 |\n",
      "2024100300000037  |     609.89 |          4 |\n",
      "2024100301000038  |      96.98 |          1 |\n",
      "2024100301000039  |      126.7 |          1 |\n",
      "2024100300000040  |     832.42 |          5 |\n",
      "2024100301000041  |     457.83 |          2 |\n",
      "2024100300000042  |     794.13 |          6 |\n",
      "2024100300000043  |     638.47 |          4 |\n",
      "2024100300000044  |     469.97 |          3 |\n",
      "2024100301000045  |     777.88 |          4 |\n",
      "2024100300000046  |     116.67 |          1 |\n",
      "2024100300000047  |     332.15 |          3 |\n",
      "2024100301000048  |     146.74 |          1 |\n",
      "2024100301000049  |     317.26 |          2 |\n",
      "2024100401000000  |     129.87 |          1 |\n",
      "2024100401000001  |      171.9 |          1 |\n",
      "2024100400000002  |     1251.4 |          6 |\n",
      "2024100401000003  |     165.66 |          1 |\n",
      "2024100400000004  |    1207.62 |          8 |\n",
      "2024100400000005  |     285.05 |          2 |\n",
      "2024100401000006  |     236.39 |          2 |\n",
      "2024100401000007  |     123.62 |          1 |\n",
      "2024100400000008  |     259.32 |          2 |\n",
      "2024100401000009  |     302.51 |          2 |\n",
      "2024100400000010  |     390.92 |          3 |\n",
      "2024100401000011  |      308.3 |          2 |\n",
      "2024100401000012  |     177.71 |          1 |\n",
      "2024100400000013  |     432.13 |          2 |\n",
      "2024100400000014  |     801.26 |          4 |\n",
      "2024100401000015  |      99.18 |          1 |\n",
      "2024100400000016  |     442.53 |          3 |\n",
      "2024100401000017  |     118.33 |          1 |\n",
      "2024100400000018  |     248.88 |          2 |\n",
      "2024100400000019  |      99.18 |          1 |\n",
      "2024100401000020  |     804.91 |          4 |\n",
      "2024100400000021  |     968.36 |          6 |\n",
      "2024100401000022  |    1065.31 |          8 |\n",
      "2024100500000000  |    1215.14 |          9 |\n",
      "2024100500000001  |     140.26 |          1 |\n",
      "2024100500000002  |      84.85 |          1 |\n",
      "2024100500000003  |     344.54 |          2 |\n",
      "2024100500000004  |     158.78 |          1 |\n",
      "2024100501000005  |     112.56 |          1 |\n",
      "2024100500000006  |     753.53 |          5 |\n",
      "2024100500000007  |      266.6 |          2 |\n",
      "2024100500000008  |      513.0 |          4 |\n",
      "2024100500000009  |     276.54 |          2 |\n",
      "2024100500000010  |     687.71 |          5 |\n",
      "2024100500000011  |     310.56 |          2 |\n",
      "2024100500000012  |      871.5 |          5 |\n",
      "2024100500000013  |      70.27 |          1 |\n",
      "2024100500000014  |     345.66 |          2 |\n",
      "2024100501000015  |     1129.8 |          7 |\n",
      "2024100500000016  |     1345.8 |          9 |\n",
      "2024100501000017  |     370.38 |          2 |\n",
      "2024100500000018  |     336.46 |          2 |\n",
      "2024100500000019  |     707.65 |          4 |\n",
      "2024100500000020  |     415.61 |          4 |\n",
      "2024100600000000  |     209.89 |          1 |\n",
      "2024100601000001  |    1105.94 |          8 |\n",
      "2024100600000002  |     179.34 |          2 |\n",
      "2024100600000003  |     170.35 |          1 |\n",
      "2024100600000004  |      616.6 |          4 |\n",
      "2024100600000005  |     785.59 |          4 |\n",
      "2024100601000006  |     1041.0 |          9 |\n",
      "2024100600000007  |     495.77 |          4 |\n",
      "2024100600000008  |     347.16 |          2 |\n",
      "2024100601000009  |     181.85 |          1 |\n",
      "2024100600000010  |    1138.57 |          7 |\n",
      "2024100601000011  |     119.41 |          1 |\n",
      "2024100601000012  |     641.42 |          5 |\n",
      "2024100600000013  |     261.41 |          2 |\n",
      "2024100601000014  |     505.74 |          4 |\n",
      "2024100600000015  |     194.73 |          1 |\n",
      "2024100600000016  |     378.21 |          2 |\n",
      "2024100600000017  |     362.84 |          3 |\n",
      "2024100600000018  |     329.94 |          2 |\n",
      "2024100601000019  |     759.83 |          6 |\n",
      "2024100601000020  |     739.36 |          4 |\n",
      "2024100600000021  |    2166.35 |         13 |\n",
      "2024100600000022  |    1628.47 |         10 |\n",
      "2024100600000023  |      224.9 |          2 |\n",
      "2024100600000024  |      106.9 |          1 |\n",
      "2024100600000025  |     170.35 |          1 |\n",
      "2024100601000026  |     803.03 |          6 |\n",
      "2024100600000027  |     207.25 |          1 |\n",
      "2024100601000028  |     269.12 |          2 |\n",
      "2024100601000029  |     563.25 |          3 |\n",
      "2024100700000000  |      96.07 |          1 |\n",
      "2024100700000001  |     665.55 |          5 |\n",
      "2024100700000002  |     538.41 |          3 |\n",
      "2024100700000003  |     132.66 |          1 |\n",
      "2024100700000004  |     304.24 |          2 |\n",
      "2024100700000005  |     773.44 |          5 |\n",
      "2024100700000006  |     197.09 |          1 |\n",
      "2024100700000007  |     386.69 |          2 |\n",
      "2024100700000008  |     262.94 |          2 |\n",
      "2024100700000009  |     501.22 |          3 |\n",
      "2024100700000010  |      158.1 |          1 |\n",
      "2024100700000011  |     439.98 |          3 |\n",
      "2024100700000012  |     190.95 |          1 |\n",
      "2024100701000013  |    1064.33 |          7 |\n",
      "2024100700000014  |     316.66 |          2 |\n",
      "2024100700000015  |     100.79 |          1 |\n",
      "2024100700000016  |     347.71 |          2 |\n",
      "2024100700000017  |     551.07 |          4 |\n",
      "2024100700000018  |    1417.33 |         10 |\n",
      "2024100700000019  |     197.22 |          2 |\n",
      "2024100700000020  |      139.5 |          1 |\n",
      "2024100701000021  |      896.3 |          4 |\n",
      "2024100700000022  |     257.81 |          2 |\n",
      "2024100701000023  |     567.37 |          3 |\n",
      "2024100701000024  |     563.47 |          3 |\n",
      "2024100800000000  |     172.35 |          1 |\n",
      "2024100800000001  |     383.43 |          2 |\n",
      "2024100801000002  |     234.35 |          2 |\n",
      "2024100800000003  |     139.55 |          1 |\n",
      "2024100800000004  |     172.92 |          1 |\n",
      "2024100800000005  |     489.21 |          3 |\n",
      "2024100801000006  |     277.82 |          2 |\n",
      "2024100800000007  |     511.59 |          3 |\n",
      "2024100800000008  |     237.11 |          2 |\n",
      "2024100800000009  |     535.56 |          3 |\n",
      "2024100801000010  |     282.14 |          2 |\n",
      "2024100800000011  |     367.23 |          2 |\n",
      "2024100801000012  |     456.44 |          2 |\n",
      "2024100801000013  |     526.94 |          4 |\n",
      "2024100800000014  |     361.04 |          3 |\n",
      "2024100800000015  |     153.24 |          1 |\n",
      "2024100800000016  |     445.65 |          4 |\n",
      "2024100801000017  |     254.23 |          2 |\n",
      "2024100800000018  |     149.63 |          1 |\n",
      "2024100801000019  |     113.11 |          1 |\n",
      "2024100800000020  |     867.91 |          4 |\n",
      "2024100800000021  |     155.86 |          1 |\n",
      "2024100800000022  |     208.82 |          2 |\n",
      "2024100901000000  |     606.06 |          2 |\n",
      "2024100901000001  |     214.58 |          1 |\n",
      "2024100901000002  |     502.63 |          3 |\n",
      "2024100900000003  |     636.27 |          4 |\n",
      "2024100900000004  |     303.87 |          2 |\n",
      "2024100900000005  |     249.11 |          2 |\n",
      "2024100900000006  |     262.16 |          2 |\n",
      "2024100900000007  |     645.51 |          4 |\n",
      "2024100900000008  |      283.7 |          2 |\n",
      "2024100901000009  |      78.68 |          1 |\n",
      "2024100900000010  |      75.47 |          1 |\n",
      "2024100900000011  |     259.06 |          1 |\n",
      "2024100900000012  |     1144.5 |          8 |\n",
      "2024100900000013  |      182.4 |          1 |\n",
      "2024100901000014  |     806.18 |          5 |\n",
      "2024100901000015  |    1140.74 |          9 |\n",
      "2024100900000016  |      128.1 |          1 |\n",
      "2024100900000017  |     161.89 |          1 |\n",
      "2024100901000018  |     132.82 |          1 |\n",
      "2024100900000019  |     174.13 |          1 |\n",
      "2024100901000020  |     697.52 |          4 |\n",
      "2024100900000021  |     138.82 |          1 |\n",
      "2024100900000022  |     267.38 |          2 |\n",
      "2024100901000023  |     205.65 |          1 |\n",
      "2024100900000024  |     1275.3 |          9 |\n",
      "20241001000000000 |      952.5 |          5 |\n",
      "20241001000000001 |     247.33 |          2 |\n",
      "20241001001000002 |     288.72 |          2 |\n",
      "20241001000000003 |     386.88 |          3 |\n",
      "20241001000000004 |     120.27 |          1 |\n",
      "20241001000000005 |     194.21 |          1 |\n",
      "20241001000000006 |     116.19 |          1 |\n",
      "20241001000000007 |    1022.32 |          8 |\n",
      "20241001000000008 |     206.22 |          2 |\n",
      "20241001000000009 |     137.56 |          1 |\n",
      "20241001001000010 |     810.54 |          4 |\n",
      "20241001001000011 |     125.07 |          1 |\n",
      "20241001001000012 |     498.44 |          4 |\n",
      "20241001000000013 |     760.64 |          5 |\n",
      "20241001000000014 |     1638.8 |          9 |\n",
      "20241001001000015 |     141.37 |          1 |\n",
      "20241001000000016 |     117.01 |          1 |\n",
      "20241001001000017 |     419.58 |          3 |\n",
      "20241001001000018 |     321.93 |          2 |\n",
      "20241001000000019 |     234.32 |          2 |\n",
      "20241001000000020 |     157.08 |          1 |\n",
      "20241001000000021 |     715.85 |          5 |\n",
      "20241001000000022 |     523.94 |          5 |\n",
      "20241001000000023 |     145.91 |          1 |\n",
      "20241001000000024 |     604.71 |          4 |\n",
      "20241001000000025 |     141.44 |          1 |\n",
      "20241001000000026 |     327.89 |          3 |\n",
      "20241001000000027 |     409.07 |          2 |\n",
      "20241001000000028 |     334.88 |          2 |\n",
      "20241001001000029 |      918.2 |          6 |\n",
      "20241001001000030 |     343.28 |          3 |\n",
      "20241001000000031 |     682.54 |          4 |\n",
      "20241001001000032 |     1176.5 |          8 |\n",
      "20241001001000033 |     394.28 |          2 |\n",
      "20241001000000034 |     1191.9 |          7 |\n",
      "20241001000000035 |     344.89 |          2 |\n",
      "2024101101000000  |     311.09 |          3 |\n",
      "2024101100000001  |     530.82 |          4 |\n",
      "2024101100000002  |     148.97 |          1 |\n",
      "2024101100000003  |     356.06 |          2 |\n",
      "2024101100000004  |     139.05 |          1 |\n",
      "2024101100000005  |    1310.06 |          8 |\n",
      "2024101101000006  |     125.93 |          1 |\n",
      "2024101101000007  |     1051.4 |          6 |\n",
      "2024101100000008  |     412.13 |          3 |\n",
      "2024101100000009  |     379.04 |          3 |\n",
      "2024101100000010  |     416.16 |          3 |\n",
      "2024101100000011  |      93.54 |          1 |\n",
      "2024101100000012  |     165.01 |          1 |\n",
      "2024101100000013  |     673.92 |          5 |\n",
      "2024101100000014  |     372.26 |          2 |\n",
      "2024101101000015  |      450.9 |          3 |\n",
      "2024101100000016  |     122.09 |          1 |\n",
      "2024101101000017  |     195.35 |          1 |\n",
      "2024101100000018  |     297.22 |          2 |\n",
      "2024101100000019  |     132.36 |          1 |\n",
      "2024101101000020  |     975.14 |          7 |\n",
      "2024101100000021  |     930.11 |          5 |\n",
      "2024101100000022  |     273.89 |          2 |\n",
      "2024101100000023  |    1353.35 |          9 |\n",
      "2024101101000024  |     408.02 |          2 |\n",
      "2024101100000025  |    1128.79 |          6 |\n",
      "2024101100000026  |     236.41 |          2 |\n",
      "2024101100000027  |     156.33 |          1 |\n",
      "2024101100000028  |     364.21 |          2 |\n",
      "2024101101000029  |     335.59 |          2 |\n",
      "2024101101000030  |     558.94 |          4 |\n",
      "2024101100000031  |     447.98 |          3 |\n",
      "2024101100000032  |     119.73 |          1 |\n",
      "2024101101000033  |    1470.93 |         10 |\n",
      "2024101100000034  |     442.24 |          2 |\n",
      "2024101101000035  |     380.47 |          2 |\n",
      "2024101100000036  |     454.19 |          4 |\n",
      "2024101100000037  |     647.67 |          5 |\n",
      "2024101100000038  |    1228.54 |          9 |\n",
      "2024101100000039  |     139.95 |          1 |\n",
      "2024101100000040  |     993.33 |          7 |\n",
      "2024101100000041  |     485.08 |          4 |\n",
      "2024101101000042  |     256.98 |          2 |\n",
      "2024101100000043  |     312.21 |          2 |\n",
      "2024101200000000  |     154.85 |          1 |\n",
      "2024101201000001  |     332.66 |          2 |\n",
      "2024101200000002  |     867.31 |          5 |\n",
      "2024101200000003  |     267.94 |          2 |\n",
      "2024101200000004  |     498.78 |          3 |\n",
      "2024101200000005  |     274.16 |          2 |\n",
      "2024101200000006  |      315.4 |          2 |\n",
      "2024101200000007  |     364.65 |          3 |\n",
      "2024101201000008  |     793.11 |          4 |\n",
      "2024101201000009  |     333.65 |          2 |\n",
      "2024101200000010  |     298.16 |          2 |\n",
      "2024101200000011  |     503.22 |          3 |\n",
      "2024101201000012  |     310.76 |          2 |\n",
      "2024101200000013  |     321.93 |          3 |\n",
      "2024101201000014  |      827.3 |          5 |\n",
      "2024101200000015  |     159.02 |          1 |\n",
      "2024101200000016  |     468.78 |          3 |\n",
      "2024101200000017  |     181.34 |          1 |\n",
      "2024101200000018  |      757.1 |          5 |\n",
      "2024101201000019  |      98.35 |          1 |\n",
      "2024101200000020  |     274.52 |          2 |\n",
      "2024101200000021  |     988.43 |          7 |\n",
      "2024101200000022  |     161.24 |          1 |\n",
      "2024101200000023  |     363.14 |          2 |\n",
      "2024101200000024  |     261.29 |          2 |\n",
      "2024101200000025  |     183.18 |          2 |\n",
      "2024101200000026  |     606.84 |          5 |\n",
      "2024101200000027  |    1405.12 |          6 |\n",
      "2024101201000028  |     814.24 |          7 |\n",
      "2024101200000029  |     334.27 |          2 |\n",
      "2024101201000030  |     625.86 |          3 |\n",
      "2024101200000031  |     704.98 |          4 |\n",
      "2024101201000032  |     647.94 |          4 |\n",
      "2024101200000033  |    1610.01 |          9 |\n",
      "2024101201000034  |     172.63 |          1 |\n",
      "2024101200000035  |      366.8 |          3 |\n",
      "2024101200000036  |     648.21 |          3 |\n",
      "2024101200000037  |     318.81 |          2 |\n",
      "2024101200000038  |     466.75 |          3 |\n",
      "2024101201000039  |     356.37 |          2 |\n",
      "2024101200000040  |      238.0 |          1 |\n",
      "2024101200000041  |     403.97 |          3 |\n",
      "2024101201000042  |     161.28 |          1 |\n",
      "2024101200000043  |     297.31 |          1 |\n",
      "2024101200000044  |     297.39 |          2 |\n",
      "2024101200000045  |    1416.02 |          8 |\n",
      "2024101201000046  |     849.73 |          5 |\n",
      "2024101200000047  |     176.87 |          1 |\n",
      "2024101200000048  |    1087.92 |          6 |\n",
      "2024101201000049  |      391.2 |          2 |\n",
      "2024101301000000  |     499.55 |          3 |\n",
      "2024101300000001  |     225.07 |          2 |\n",
      "2024101300000002  |     189.72 |          1 |\n",
      "2024101301000003  |     337.63 |          2 |\n",
      "2024101300000004  |     449.91 |          3 |\n",
      "2024101300000005  |     482.53 |          3 |\n",
      "2024101300000006  |     339.48 |          2 |\n",
      "2024101300000007  |     119.29 |          1 |\n",
      "2024101300000008  |     213.43 |          1 |\n",
      "2024101300000009  |      281.9 |          2 |\n",
      "2024101301000010  |     693.33 |          4 |\n",
      "2024101300000011  |     315.44 |          3 |\n",
      "2024101300000012  |     276.18 |          2 |\n",
      "2024101300000013  |     744.88 |          5 |\n",
      "2024101300000014  |    1248.89 |          9 |\n",
      "2024101300000015  |     714.53 |          5 |\n",
      "2024101301000016  |    1160.46 |          8 |\n",
      "2024101301000017  |    1059.47 |          7 |\n",
      "2024101300000018  |     325.14 |          2 |\n",
      "2024101300000019  |     109.69 |          1 |\n",
      "2024101300000020  |     933.59 |          6 |\n",
      "2024101301000021  |     373.62 |          2 |\n",
      "2024101301000022  |     382.43 |          3 |\n",
      "2024101301000023  |     151.63 |          1 |\n",
      "2024101300000024  |     230.16 |          2 |\n",
      "2024101300000025  |     375.25 |          3 |\n",
      "2024101300000026  |      105.0 |          1 |\n",
      "2024101301000027  |     996.86 |          6 |\n",
      "2024101300000028  |     377.83 |          3 |\n",
      "2024101301000029  |     339.19 |          2 |\n",
      "2024101301000030  |     350.91 |          2 |\n",
      "2024101300000031  |      380.8 |          2 |\n",
      "2024101300000032  |     254.83 |          2 |\n",
      "2024101301000033  |     664.12 |          5 |\n",
      "2024101300000034  |     114.24 |          1 |\n",
      "2024101300000035  |     333.76 |          2 |\n",
      "2024101301000036  |     712.45 |          5 |\n",
      "2024101300000037  |     123.68 |          1 |\n",
      "2024101301000038  |     123.68 |          1 |\n",
      "2024101301000039  |     131.28 |          1 |\n",
      "2024101300000040  |     723.17 |          4 |\n",
      "2024101300000041  |     522.03 |          3 |\n",
      "2024101300000042  |     321.37 |          2 |\n",
      "2024101300000043  |     453.54 |          3 |\n",
      "2024101400000000  |     536.74 |          3 |\n",
      "2024101400000001  |     383.32 |          2 |\n",
      "2024101400000002  |     724.64 |          4 |\n",
      "2024101400000003  |    1258.25 |          8 |\n",
      "2024101400000004  |     275.46 |          2 |\n",
      "2024101400000005  |     124.34 |          1 |\n",
      "2024101400000006  |     117.21 |          1 |\n",
      "2024101400000007  |     505.45 |          4 |\n",
      "2024101401000008  |      124.1 |          1 |\n",
      "2024101401000009  |    1276.77 |          8 |\n",
      "2024101400000010  |     498.55 |          4 |\n",
      "2024101400000011  |     925.24 |          6 |\n",
      "2024101400000012  |      91.39 |          1 |\n",
      "2024101400000013  |     151.63 |          1 |\n",
      "2024101400000014  |     102.06 |          1 |\n",
      "2024101400000015  |     147.83 |          1 |\n",
      "2024101401000016  |     143.85 |          1 |\n",
      "2024101400000017  |     723.69 |          4 |\n",
      "2024101400000018  |     680.58 |          4 |\n",
      "2024101400000019  |     124.63 |          1 |\n",
      "2024101400000020  |     174.37 |          1 |\n",
      "2024101401000021  |     104.67 |          1 |\n",
      "2024101401000022  |    1380.21 |          9 |\n",
      "2024101401000023  |     159.81 |          1 |\n",
      "2024101401000024  |     447.45 |          4 |\n",
      "2024101401000025  |    1009.68 |          7 |\n",
      "2024101401000026  |     279.24 |          3 |\n",
      "2024101401000027  |      309.4 |          2 |\n",
      "2024101400000028  |     338.17 |          3 |\n",
      "2024101400000029  |     949.82 |          7 |\n",
      "2024101400000030  |     381.11 |          2 |\n",
      "2024101401000031  |     648.97 |          4 |\n",
      "2024101501000000  |     294.56 |          2 |\n",
      "2024101500000001  |    1141.36 |          7 |\n",
      "2024101501000002  |     116.68 |          1 |\n",
      "2024101501000003  |     229.29 |          2 |\n",
      "2024101500000004  |     858.08 |          6 |\n",
      "2024101500000005  |     269.38 |          2 |\n",
      "2024101501000006  |     402.64 |          3 |\n",
      "2024101501000007  |     321.18 |          2 |\n",
      "2024101501000008  |     292.25 |          2 |\n",
      "2024101500000009  |     299.31 |          3 |\n",
      "2024101500000010  |    2008.08 |         11 |\n",
      "2024101500000011  |      599.5 |          4 |\n",
      "2024101500000012  |    1034.76 |          8 |\n",
      "2024101500000013  |     257.04 |          2 |\n",
      "2024101501000014  |     259.12 |          2 |\n",
      "2024101501000015  |     365.47 |          3 |\n",
      "2024101500000016  |     429.94 |          4 |\n",
      "2024101500000017  |     364.72 |          3 |\n",
      "2024101500000018  |     416.58 |          3 |\n",
      "2024101500000019  |     475.13 |          3 |\n",
      "2024101501000020  |     921.63 |          5 |\n",
      "2024101500000021  |     223.83 |          2 |\n",
      "2024101500000022  |     101.27 |          1 |\n",
      "2024101501000023  |     484.66 |          3 |\n",
      "2024101501000024  |      197.9 |          1 |\n",
      "2024101500000025  |     465.98 |          3 |\n",
      "2024101500000026  |     603.98 |          3 |\n",
      "2024101500000027  |     154.85 |          1 |\n",
      "2024101500000028  |     530.68 |          3 |\n",
      "2024101501000029  |     241.79 |          1 |\n",
      "2024101500000030  |    1171.18 |          7 |\n",
      "2024101500000031  |     728.34 |          4 |\n",
      "2024101500000032  |     992.28 |          7 |\n",
      "2024101501000033  |     101.28 |          1 |\n",
      "2024101501000034  |     454.15 |          3 |\n",
      "2024101500000035  |     277.37 |          2 |\n",
      "2024101501000036  |     334.64 |          2 |\n",
      "2024101500000037  |     330.42 |          2 |\n",
      "2024101500000038  |     141.23 |          1 |\n",
      "2024101500000039  |     287.74 |          2 |\n",
      "2024101500000040  |     740.32 |          5 |\n",
      "2024101501000041  |     358.52 |          2 |\n",
      "2024101501000042  |     449.08 |          3 |\n",
      "2024101501000043  |       77.2 |          1 |\n",
      "2024101600000000  |     487.41 |          3 |\n",
      "2024101600000001  |     157.67 |          1 |\n",
      "2024101600000002  |     416.17 |          3 |\n",
      "2024101601000003  |     531.01 |          4 |\n",
      "2024101600000004  |    1355.93 |          8 |\n",
      "2024101600000005  |     198.15 |          2 |\n",
      "2024101600000006  |     431.91 |          4 |\n",
      "2024101601000007  |     280.15 |          2 |\n",
      "2024101600000008  |     647.52 |          3 |\n",
      "2024101601000009  |     192.13 |          1 |\n",
      "2024101600000010  |     115.42 |          1 |\n",
      "2024101600000011  |     174.99 |          1 |\n",
      "2024101600000012  |     266.04 |          2 |\n",
      "2024101601000013  |     891.67 |          7 |\n",
      "2024101601000014  |     967.06 |          7 |\n",
      "2024101600000015  |     348.74 |          2 |\n",
      "2024101600000016  |     244.87 |          2 |\n",
      "2024101601000017  |     385.86 |          3 |\n",
      "2024101601000018  |     166.86 |          1 |\n",
      "2024101600000019  |     528.34 |          4 |\n",
      "2024101601000020  |    1181.15 |          6 |\n",
      "2024101600000021  |     414.52 |          3 |\n",
      "2024101700000000  |     738.19 |          5 |\n",
      "2024101700000001  |     165.66 |          2 |\n",
      "2024101700000002  |     313.63 |          2 |\n",
      "2024101701000003  |     306.29 |          2 |\n",
      "2024101700000004  |     480.13 |          3 |\n",
      "2024101700000005  |     312.32 |          2 |\n",
      "2024101700000006  |     131.32 |          1 |\n",
      "2024101700000007  |      952.2 |          6 |\n",
      "2024101700000008  |     154.42 |          1 |\n",
      "2024101700000009  |    1463.34 |          8 |\n",
      "2024101700000010  |     394.18 |          2 |\n",
      "2024101700000011  |    1074.69 |          8 |\n",
      "2024101700000012  |    1186.02 |          8 |\n",
      "2024101701000013  |     285.24 |          2 |\n",
      "2024101701000014  |     438.59 |          3 |\n",
      "2024101701000015  |     899.55 |          6 |\n",
      "2024101700000016  |     677.16 |          4 |\n",
      "2024101701000017  |     549.19 |          3 |\n",
      "2024101700000018  |     318.84 |          2 |\n",
      "2024101700000019  |     747.04 |          6 |\n",
      "2024101700000020  |     231.27 |          1 |\n",
      "2024101700000021  |     346.32 |          2 |\n",
      "2024101700000022  |     311.58 |          2 |\n",
      "2024101701000023  |     151.01 |          1 |\n",
      "2024101700000024  |     968.54 |          5 |\n",
      "2024101700000025  |     517.33 |          4 |\n",
      "2024101700000026  |     148.52 |          1 |\n",
      "2024101701000027  |    1272.96 |         10 |\n",
      "2024101700000028  |     336.85 |          2 |\n",
      "2024101701000029  |     356.63 |          2 |\n",
      "2024101700000030  |     486.14 |          3 |\n",
      "2024101700000031  |     165.82 |          1 |\n",
      "2024101700000032  |     330.97 |          3 |\n",
      "2024101700000033  |     788.82 |          5 |\n",
      "2024101701000034  |      102.1 |          1 |\n",
      "2024101700000035  |     271.76 |          2 |\n",
      "2024101701000036  |     173.88 |          1 |\n",
      "2024101701000037  |     858.36 |          7 |\n",
      "2024101700000038  |    1531.86 |         10 |\n",
      "2024101701000039  |      187.9 |          1 |\n",
      "2024101700000040  |     829.18 |          5 |\n",
      "2024101701000041  |     529.18 |          3 |\n",
      "2024101701000042  |     248.08 |          2 |\n",
      "2024101701000043  |     697.29 |          4 |\n",
      "2024101701000044  |      293.0 |          3 |\n",
      "2024101700000045  |     400.32 |          3 |\n",
      "2024101700000046  |     165.53 |          1 |\n",
      "2024101700000047  |      805.4 |          4 |\n",
      "2024101701000048  |     798.78 |          3 |\n",
      "2024101700000049  |     331.45 |          2 |\n",
      "2024101800000000  |     117.01 |          1 |\n",
      "2024101801000001  |     141.01 |          1 |\n",
      "2024101800000002  |      378.0 |          2 |\n",
      "2024101800000003  |     593.21 |          4 |\n",
      "2024101801000004  |      558.6 |          3 |\n",
      "2024101800000005  |     154.61 |          1 |\n",
      "2024101800000006  |     144.59 |          1 |\n",
      "2024101800000007  |     247.38 |          2 |\n",
      "2024101800000008  |     177.71 |          1 |\n",
      "2024101801000009  |     702.63 |          6 |\n",
      "2024101800000010  |     336.67 |          2 |\n",
      "2024101801000011  |     148.13 |          1 |\n",
      "2024101800000012  |     448.07 |          3 |\n",
      "2024101801000013  |     315.49 |          1 |\n",
      "2024101801000014  |     901.68 |          6 |\n",
      "2024101800000015  |     852.86 |          7 |\n",
      "2024101800000016  |     431.09 |          3 |\n",
      "2024101800000017  |     677.02 |          4 |\n",
      "2024101800000018  |    1511.77 |          9 |\n",
      "2024101800000019  |     505.08 |          3 |\n",
      "2024101801000020  |     138.76 |          1 |\n",
      "2024101800000021  |     249.65 |          2 |\n",
      "2024101800000022  |     358.71 |          2 |\n",
      "2024101801000023  |     353.84 |          2 |\n",
      "2024101900000000  |     341.99 |          2 |\n",
      "2024101901000001  |      428.4 |          2 |\n",
      "2024101900000002  |     459.99 |          3 |\n",
      "2024101900000003  |     455.95 |          3 |\n",
      "2024101900000004  |     436.54 |          3 |\n",
      "2024101901000005  |      134.2 |          1 |\n",
      "2024101900000006  |     215.79 |          1 |\n",
      "2024101900000007  |     103.11 |          1 |\n",
      "2024101900000008  |     123.29 |          1 |\n",
      "2024101900000009  |     111.12 |          1 |\n",
      "2024101900000010  |      118.5 |          1 |\n",
      "2024101901000011  |     130.61 |          1 |\n",
      "2024101901000012  |     122.64 |          1 |\n",
      "2024101900000013  |      353.4 |          2 |\n",
      "2024101900000014  |     221.92 |          2 |\n",
      "2024101900000015  |     461.71 |          3 |\n",
      "2024101901000016  |     255.35 |          2 |\n",
      "2024101901000017  |     338.31 |          3 |\n",
      "2024101900000018  |      96.17 |          1 |\n",
      "2024101900000019  |     647.63 |          3 |\n",
      "2024101900000020  |     454.22 |          3 |\n",
      "2024101900000021  |     274.82 |          2 |\n",
      "2024101900000022  |     470.03 |          3 |\n",
      "2024101900000023  |     386.21 |          2 |\n",
      "2024101901000024  |     811.72 |          5 |\n",
      "2024101900000025  |    1324.53 |          9 |\n",
      "2024101900000026  |     646.34 |          4 |\n",
      "2024101900000027  |     314.86 |          2 |\n",
      "2024101900000028  |     268.49 |          2 |\n",
      "2024101900000029  |     851.34 |          5 |\n",
      "2024102000000000  |     112.45 |          1 |\n",
      "2024102000000001  |    1288.43 |          8 |\n",
      "2024102001000002  |     329.76 |          2 |\n",
      "2024102000000003  |     448.46 |          3 |\n",
      "2024102000000004  |     317.97 |          2 |\n",
      "2024102000000005  |     409.36 |          3 |\n",
      "2024102000000006  |     926.66 |          6 |\n",
      "2024102000000007  |     321.79 |          3 |\n",
      "2024102000000008  |     318.43 |          2 |\n",
      "2024102000000009  |     222.92 |          1 |\n",
      "2024102001000010  |     935.62 |          6 |\n",
      "2024102000000011  |     192.13 |          1 |\n",
      "2024102000000012  |     236.85 |          2 |\n",
      "2024102000000013  |      990.4 |          5 |\n",
      "2024102001000014  |     321.09 |          2 |\n",
      "2024102000000015  |      119.8 |          1 |\n",
      "2024102000000016  |     150.48 |          1 |\n",
      "2024102000000017  |     245.38 |          2 |\n",
      "2024102000000018  |     580.27 |          4 |\n",
      "2024102001000019  |     251.34 |          2 |\n",
      "2024102000000020  |     248.81 |          2 |\n",
      "2024102101000000  |    1172.23 |          8 |\n",
      "2024102100000001  |     403.38 |          3 |\n",
      "2024102100000002  |     190.95 |          1 |\n",
      "2024102100000003  |     557.91 |          3 |\n",
      "2024102100000004  |    1272.81 |         10 |\n",
      "2024102100000005  |    1697.25 |         10 |\n",
      "2024102100000006  |     242.14 |          2 |\n",
      "2024102100000007  |     191.22 |          2 |\n",
      "2024102100000008  |     901.95 |          6 |\n",
      "2024102100000009  |     773.64 |          4 |\n",
      "2024102100000010  |     194.68 |          1 |\n",
      "2024102100000011  |     398.86 |          3 |\n",
      "2024102101000012  |     175.21 |          1 |\n",
      "2024102100000013  |     137.56 |          1 |\n",
      "2024102100000014  |     900.89 |          7 |\n",
      "2024102101000015  |     115.08 |          1 |\n",
      "2024102101000016  |     274.61 |          2 |\n",
      "2024102101000017  |     977.98 |          7 |\n",
      "2024102100000018  |     528.61 |          3 |\n",
      "2024102100000019  |      86.43 |          1 |\n",
      "2024102101000020  |    1046.34 |          7 |\n",
      "2024102100000021  |     856.01 |          7 |\n",
      "2024102101000022  |     679.46 |          5 |\n",
      "2024102100000023  |     146.79 |          1 |\n",
      "2024102101000024  |     101.27 |          1 |\n",
      "2024102100000025  |     148.97 |          1 |\n",
      "2024102101000026  |     270.98 |          2 |\n",
      "2024102101000027  |     318.94 |          3 |\n",
      "2024102100000028  |     211.95 |          1 |\n",
      "2024102101000029  |     298.92 |          2 |\n",
      "2024102100000030  |     273.44 |          2 |\n",
      "2024102101000031  |     153.24 |          1 |\n",
      "2024102200000000  |     294.76 |          2 |\n",
      "2024102201000001  |     492.35 |          3 |\n",
      "2024102200000002  |     578.62 |          3 |\n",
      "2024102201000003  |     246.61 |          2 |\n",
      "2024102200000004  |      313.5 |          2 |\n",
      "2024102200000005  |     932.36 |          6 |\n",
      "2024102201000006  |     392.78 |          3 |\n",
      "2024102200000007  |     272.85 |          2 |\n",
      "2024102201000008  |    1235.11 |          7 |\n",
      "2024102201000009  |     470.77 |          4 |\n",
      "2024102201000010  |     512.44 |          3 |\n",
      "2024102200000011  |     588.28 |          3 |\n",
      "2024102201000012  |     807.17 |          5 |\n",
      "2024102200000013  |     848.74 |          6 |\n",
      "2024102200000014  |     310.96 |          2 |\n",
      "2024102200000015  |     491.35 |          3 |\n",
      "2024102200000016  |     141.35 |          1 |\n",
      "2024102201000017  |     240.36 |          2 |\n",
      "2024102200000018  |     246.46 |          2 |\n",
      "2024102200000019  |    1796.97 |          9 |\n",
      "2024102200000020  |     453.31 |          3 |\n",
      "2024102201000021  |     479.57 |          3 |\n",
      "2024102201000022  |     128.25 |          1 |\n",
      "2024102201000023  |     600.58 |          5 |\n",
      "2024102200000024  |     668.65 |          4 |\n",
      "2024102200000025  |     380.45 |          3 |\n",
      "2024102300000000  |     565.96 |          3 |\n",
      "2024102301000001  |     748.58 |          5 |\n",
      "2024102301000002  |     290.15 |          2 |\n",
      "2024102301000003  |     324.51 |          3 |\n",
      "2024102300000004  |    1287.83 |          7 |\n",
      "2024102300000005  |     288.93 |          2 |\n",
      "2024102301000006  |     172.52 |          2 |\n",
      "2024102300000007  |     232.36 |          2 |\n",
      "2024102300000008  |     150.48 |          1 |\n",
      "2024102300000009  |     402.69 |          3 |\n",
      "2024102300000010  |     371.05 |          2 |\n",
      "2024102300000011  |     296.78 |          3 |\n",
      "2024102300000012  |    1017.24 |          7 |\n",
      "2024102300000013  |     343.43 |          3 |\n",
      "2024102301000014  |     280.42 |          2 |\n",
      "2024102300000015  |     715.56 |          4 |\n",
      "2024102300000016  |     594.97 |          3 |\n",
      "2024102300000017  |     281.56 |          2 |\n",
      "2024102300000018  |     594.66 |          3 |\n",
      "2024102301000019  |     232.47 |          2 |\n",
      "2024102301000020  |      306.6 |          2 |\n",
      "2024102300000021  |     566.52 |          2 |\n",
      "2024102300000022  |      93.54 |          1 |\n",
      "2024102301000023  |     711.39 |          4 |\n",
      "2024102300000024  |    1006.29 |          7 |\n",
      "2024102301000025  |     343.08 |          2 |\n",
      "2024102300000026  |     369.48 |          2 |\n",
      "2024102300000027  |     257.92 |          2 |\n",
      "2024102301000028  |     172.27 |          1 |\n",
      "2024102300000029  |      248.1 |          2 |\n",
      "2024102300000030  |      432.0 |          3 |\n",
      "2024102300000031  |     885.93 |          5 |\n",
      "2024102301000032  |     514.71 |          5 |\n",
      "2024102300000033  |      588.7 |          3 |\n",
      "2024102300000034  |     776.28 |          5 |\n",
      "2024102301000035  |     374.98 |          3 |\n",
      "2024102400000000  |      89.59 |          1 |\n",
      "2024102401000001  |     157.65 |          1 |\n",
      "2024102400000002  |     285.25 |          2 |\n",
      "2024102400000003  |     183.46 |          1 |\n",
      "2024102401000004  |     309.44 |          2 |\n",
      "2024102400000005  |     115.42 |          1 |\n",
      "2024102400000006  |     1107.4 |          7 |\n",
      "2024102401000007  |      983.6 |          6 |\n",
      "2024102401000008  |      90.37 |          1 |\n",
      "2024102401000009  |     362.51 |          3 |\n",
      "2024102401000010  |     195.54 |          2 |\n",
      "2024102400000011  |     291.94 |          2 |\n",
      "2024102401000012  |     211.17 |          1 |\n",
      "2024102401000013  |      140.7 |          1 |\n",
      "2024102400000014  |     541.31 |          4 |\n",
      "2024102400000015  |     576.56 |          3 |\n",
      "2024102400000016  |     122.64 |          1 |\n",
      "2024102401000017  |     113.02 |          1 |\n",
      "2024102400000018  |     609.51 |          5 |\n",
      "2024102401000019  |     370.42 |          2 |\n",
      "2024102400000020  |     441.37 |          3 |\n",
      "2024102400000021  |     281.25 |          2 |\n",
      "2024102400000022  |     145.19 |          1 |\n",
      "2024102400000023  |     292.62 |          1 |\n",
      "2024102400000024  |      537.6 |          3 |\n",
      "2024102400000025  |     506.82 |          3 |\n",
      "2024102400000026  |     940.16 |          8 |\n",
      "2024102400000027  |      218.2 |          2 |\n",
      "2024102401000028  |     104.67 |          1 |\n",
      "2024102401000029  |    1130.42 |          9 |\n",
      "2024102400000030  |     228.03 |          2 |\n",
      "2024102400000031  |     676.51 |          4 |\n",
      "2024102400000032  |      475.4 |          3 |\n",
      "2024102401000033  |    1090.12 |          8 |\n",
      "2024102400000034  |     300.46 |          2 |\n",
      "2024102401000035  |    1263.08 |          8 |\n",
      "2024102400000036  |     152.78 |          1 |\n",
      "2024102401000037  |     355.34 |          3 |\n",
      "2024102501000000  |     469.34 |          4 |\n",
      "2024102501000001  |     181.85 |          1 |\n",
      "2024102501000002  |     210.82 |          2 |\n",
      "2024102501000003  |     225.66 |          2 |\n",
      "2024102500000004  |    1000.21 |          6 |\n",
      "2024102501000005  |     369.64 |          3 |\n",
      "2024102501000006  |     614.74 |          5 |\n",
      "2024102500000007  |      320.7 |          3 |\n",
      "2024102501000008  |     474.26 |          3 |\n",
      "2024102501000009  |     402.86 |          3 |\n",
      "2024102500000010  |     153.33 |          1 |\n",
      "2024102501000011  |     352.48 |          2 |\n",
      "2024102500000012  |     137.26 |          1 |\n",
      "2024102501000013  |     263.96 |          2 |\n",
      "2024102501000014  |     137.26 |          1 |\n",
      "2024102500000015  |     459.34 |          2 |\n",
      "2024102500000016  |     660.19 |          5 |\n",
      "2024102500000017  |     109.05 |          1 |\n",
      "2024102501000018  |     981.08 |          6 |\n",
      "2024102501000019  |     442.73 |          3 |\n",
      "2024102501000020  |     127.97 |          1 |\n",
      "2024102501000021  |     303.98 |          3 |\n",
      "2024102501000022  |     319.31 |          2 |\n",
      "2024102500000023  |     110.29 |          1 |\n",
      "2024102500000024  |     141.04 |          1 |\n",
      "2024102500000025  |     516.95 |          3 |\n",
      "2024102500000026  |    1238.92 |          8 |\n",
      "2024102501000027  |     398.68 |          3 |\n",
      "2024102500000028  |     577.03 |          5 |\n",
      "2024102501000029  |    1530.13 |         10 |\n",
      "2024102500000030  |     331.32 |          2 |\n",
      "2024102500000031  |     367.47 |          2 |\n",
      "2024102500000032  |    1370.33 |          8 |\n",
      "2024102500000033  |     490.01 |          3 |\n",
      "2024102500000034  |     392.88 |          3 |\n",
      "2024102500000035  |     194.43 |          1 |\n",
      "2024102500000036  |     101.01 |          1 |\n",
      "2024102500000037  |     340.58 |          3 |\n",
      "2024102500000038  |     450.45 |          3 |\n",
      "2024102500000039  |     248.68 |          2 |\n",
      "2024102501000040  |    1296.65 |          9 |\n",
      "2024102500000041  |     553.74 |          3 |\n",
      "2024102501000042  |      78.21 |          1 |\n",
      "2024102500000043  |     112.69 |          1 |\n",
      "2024102500000044  |     485.12 |          3 |\n",
      "2024102501000045  |     800.09 |          5 |\n",
      "2024102500000046  |     424.07 |          2 |\n",
      "2024102501000047  |     550.28 |          3 |\n",
      "2024102501000048  |     434.85 |          3 |\n",
      "2024102500000049  |     165.81 |          1 |\n",
      "2024102500000050  |      489.5 |          3 |\n",
      "2024102500000051  |     132.66 |          1 |\n",
      "2024102501000052  |     270.59 |          2 |\n",
      "2024102501000053  |     115.27 |          1 |\n",
      "2024102500000054  |     289.24 |          2 |\n",
      "2024102500000055  |     399.21 |          3 |\n",
      "2024102601000000  |     145.12 |          1 |\n",
      "2024102600000001  |     302.24 |          1 |\n",
      "2024102601000002  |     561.43 |          3 |\n",
      "2024102601000003  |     434.89 |          3 |\n",
      "2024102600000004  |    1076.89 |          7 |\n",
      "2024102601000005  |     224.48 |          2 |\n",
      "2024102600000006  |     947.56 |          6 |\n",
      "2024102601000007  |     537.71 |          4 |\n",
      "2024102600000008  |     602.48 |          5 |\n",
      "2024102600000009  |     159.53 |          1 |\n",
      "2024102600000010  |     178.62 |          1 |\n",
      "2024102600000011  |     375.77 |          2 |\n",
      "2024102600000012  |     255.19 |          1 |\n",
      "2024102601000013  |     103.68 |          1 |\n",
      "2024102601000014  |     178.48 |          1 |\n",
      "2024102600000015  |     464.74 |          3 |\n",
      "2024102601000016  |     661.43 |          5 |\n",
      "2024102600000017  |    1584.46 |         11 |\n",
      "2024102600000018  |     545.16 |          2 |\n",
      "2024102601000019  |     156.28 |          1 |\n",
      "2024102601000020  |     406.29 |          2 |\n",
      "2024102601000021  |     124.83 |          1 |\n",
      "2024102600000022  |      381.3 |          3 |\n",
      "2024102600000023  |    1645.31 |         11 |\n",
      "2024102600000024  |     177.38 |          1 |\n",
      "2024102601000025  |     124.46 |          1 |\n",
      "2024102600000026  |      564.2 |          4 |\n",
      "2024102600000027  |     219.24 |          2 |\n",
      "2024102601000028  |      212.0 |          1 |\n",
      "2024102600000029  |     397.22 |          2 |\n",
      "2024102601000030  |     110.87 |          1 |\n",
      "2024102600000031  |     257.51 |          1 |\n",
      "2024102600000032  |     456.12 |          4 |\n",
      "2024102601000033  |     176.76 |          1 |\n",
      "2024102601000034  |     319.84 |          2 |\n",
      "2024102601000035  |     345.99 |          2 |\n",
      "2024102600000036  |      103.6 |          1 |\n",
      "2024102600000037  |     293.54 |          2 |\n",
      "2024102601000038  |    1021.57 |          7 |\n",
      "2024102601000039  |     958.26 |          8 |\n",
      "2024102601000040  |    1454.76 |          9 |\n",
      "2024102600000041  |      255.6 |          2 |\n",
      "2024102600000042  |     721.42 |          4 |\n",
      "2024102600000043  |     961.13 |          8 |\n",
      "2024102600000044  |      191.4 |          2 |\n",
      "2024102600000045  |    1329.22 |          8 |\n",
      "2024102600000046  |     172.63 |          1 |\n",
      "2024102600000047  |     163.92 |          1 |\n",
      "2024102601000048  |     728.58 |          4 |\n",
      "2024102601000049  |     522.37 |          3 |\n",
      "2024102600000050  |     452.44 |          4 |\n",
      "2024102601000051  |     281.29 |          2 |\n",
      "2024102601000052  |     402.37 |          3 |\n",
      "2024102601000053  |      406.6 |          3 |\n",
      "2024102600000054  |     123.03 |          1 |\n",
      "2024102600000055  |      90.02 |          1 |\n",
      "2024102700000000  |     308.46 |          3 |\n",
      "2024102701000001  |     308.39 |          2 |\n",
      "2024102700000002  |     400.28 |          3 |\n",
      "2024102701000003  |     932.55 |          6 |\n",
      "2024102700000004  |     1257.1 |          9 |\n",
      "2024102700000005  |     351.34 |          2 |\n",
      "2024102701000006  |     364.99 |          2 |\n",
      "2024102701000007  |     188.09 |          2 |\n",
      "2024102700000008  |     144.36 |          1 |\n",
      "2024102700000009  |     504.16 |          4 |\n",
      "2024102700000010  |     140.21 |          1 |\n",
      "2024102700000011  |    1208.99 |          8 |\n",
      "2024102700000012  |     438.23 |          3 |\n",
      "2024102700000013  |     267.72 |          2 |\n",
      "2024102701000014  |      285.5 |          2 |\n",
      "2024102700000015  |     243.42 |          2 |\n",
      "2024102700000016  |     294.89 |          2 |\n",
      "2024102700000017  |     339.24 |          3 |\n",
      "2024102701000018  |     137.56 |          1 |\n",
      "2024102701000019  |     1259.5 |          9 |\n",
      "2024102700000020  |     1227.4 |          8 |\n",
      "2024102701000021  |      239.0 |          2 |\n",
      "2024102700000022  |     428.75 |          3 |\n",
      "2024102700000023  |     440.23 |          3 |\n",
      "2024102700000024  |     457.77 |          4 |\n",
      "2024102700000025  |     192.09 |          1 |\n",
      "2024102701000026  |     104.45 |          1 |\n",
      "2024102701000027  |     116.51 |          1 |\n",
      "2024102700000028  |     333.66 |          2 |\n",
      "2024102701000029  |     386.14 |          2 |\n",
      "2024102701000030  |     397.27 |          3 |\n",
      "2024102700000031  |     229.92 |          2 |\n",
      "2024102700000032  |    1350.36 |         10 |\n",
      "2024102701000033  |     330.57 |          2 |\n",
      "2024102701000034  |     241.39 |          2 |\n",
      "2024102700000035  |     280.15 |          2 |\n",
      "2024102700000036  |     467.82 |          3 |\n",
      "2024102700000037  |     496.13 |          4 |\n",
      "2024102700000038  |     963.38 |          6 |\n",
      "2024102700000039  |    1279.47 |          9 |\n",
      "2024102800000000  |      196.7 |          1 |\n",
      "2024102801000001  |     415.93 |          3 |\n",
      "2024102800000002  |     353.58 |          3 |\n",
      "2024102801000003  |     231.25 |          1 |\n",
      "2024102801000004  |     348.02 |          2 |\n",
      "2024102801000005  |     890.31 |          5 |\n",
      "2024102800000006  |     161.24 |          1 |\n",
      "2024102800000007  |     814.74 |          7 |\n",
      "2024102801000008  |     289.86 |          2 |\n",
      "2024102800000009  |     267.33 |          2 |\n",
      "2024102800000010  |     231.11 |          2 |\n",
      "2024102800000011  |     859.66 |          6 |\n",
      "2024102800000012  |     161.22 |          1 |\n",
      "2024102800000013  |     141.38 |          1 |\n",
      "2024102800000014  |     413.45 |          2 |\n",
      "2024102801000015  |    1167.52 |          7 |\n",
      "2024102800000016  |     101.77 |          1 |\n",
      "2024102800000017  |     112.46 |          1 |\n",
      "2024102800000018  |     762.06 |          5 |\n",
      "2024102800000019  |     309.89 |          2 |\n",
      "2024102801000020  |     114.24 |          1 |\n",
      "2024102801000021  |      334.9 |          2 |\n",
      "2024102800000022  |     376.69 |          2 |\n",
      "2024102900000000  |    1406.85 |         10 |\n",
      "2024102900000001  |    1239.34 |          6 |\n",
      "2024102900000002  |    1421.82 |          9 |\n",
      "2024102900000003  |    1017.04 |          6 |\n",
      "2024102900000004  |      270.7 |          2 |\n",
      "2024102900000005  |     113.97 |          1 |\n",
      "2024102900000006  |    1074.25 |          7 |\n",
      "2024102900000007  |     219.88 |          2 |\n",
      "2024102900000008  |     251.43 |          2 |\n",
      "2024102901000009  |     168.96 |          1 |\n",
      "2024102900000010  |     567.25 |          4 |\n",
      "2024102900000011  |     159.75 |          1 |\n",
      "2024102900000012  |     247.76 |          1 |\n",
      "2024102901000013  |      783.7 |          4 |\n",
      "2024102901000014  |     221.78 |          2 |\n",
      "2024102900000015  |      171.9 |          1 |\n",
      "2024102900000016  |     473.01 |          3 |\n",
      "2024102900000017  |     247.26 |          3 |\n",
      "2024102900000018  |     273.88 |          2 |\n",
      "2024102900000019  |     324.91 |          2 |\n",
      "2024102900000020  |     693.07 |          4 |\n",
      "2024102900000021  |      590.4 |          5 |\n",
      "2024102900000022  |     786.04 |          5 |\n",
      "2024102900000023  |     398.05 |          3 |\n",
      "2024103000000000  |     430.72 |          3 |\n",
      "2024103000000001  |      327.3 |          2 |\n",
      "2024103000000002  |     699.08 |          5 |\n",
      "2024103001000003  |     416.02 |          2 |\n",
      "2024103000000004  |     743.28 |          3 |\n",
      "2024103000000005  |     158.78 |          1 |\n",
      "2024103001000006  |     293.44 |          2 |\n",
      "2024103001000007  |     173.11 |          1 |\n",
      "2024103000000008  |     293.34 |          2 |\n",
      "2024103000000009  |      205.2 |          1 |\n",
      "2024103000000010  |     414.13 |          4 |\n",
      "2024103000000011  |     429.62 |          3 |\n",
      "2024103001000012  |     512.82 |          3 |\n",
      "2024103000000013  |     112.17 |          1 |\n",
      "2024103000000014  |     824.86 |          6 |\n",
      "2024103001000015  |      94.26 |          1 |\n",
      "2024103000000016  |     355.27 |          3 |\n",
      "2024103000000017  |     124.69 |          1 |\n",
      "2024103000000018  |     703.87 |          4 |\n",
      "2024103000000019  |     567.88 |          2 |\n",
      "2024103001000020  |    1346.48 |          9 |\n",
      "2024103000000021  |     418.45 |          3 |\n",
      "2024103000000022  |     228.48 |          2 |\n",
      "2024103001000023  |     477.65 |          4 |\n",
      "2024103000000024  |     504.59 |          3 |\n",
      "2024103000000025  |     840.73 |          4 |\n",
      "2024103000000026  |      149.2 |          1 |\n",
      "2024103001000027  |      738.1 |          5 |\n",
      "2024103000000028  |     518.38 |          3 |\n",
      "2024103001000029  |      323.3 |          2 |\n",
      "2024103000000030  |    1093.21 |          5 |\n",
      "2024103000000031  |     450.65 |          3 |\n",
      "2024103001000032  |     443.31 |          3 |\n",
      "2024103000000033  |     943.82 |          6 |\n",
      "2024103000000034  |     243.38 |          2 |\n",
      "2024103100000000  |    1495.93 |          9 |\n",
      "2024103100000001  |     483.26 |          3 |\n",
      "2024103100000002  |     105.39 |          1 |\n",
      "2024103100000003  |     216.21 |          2 |\n",
      "2024103101000004  |     127.07 |          1 |\n",
      "2024103100000005  |     109.69 |          1 |\n",
      "2024103100000006  |     318.33 |          2 |\n",
      "2024103100000007  |      96.98 |          1 |\n",
      "2024103100000008  |     391.89 |          2 |\n",
      "2024103100000009  |     446.22 |          3 |\n",
      "2024103101000010  |     608.39 |          4 |\n",
      "2024103100000011  |     662.42 |          5 |\n",
      "2024103101000012  |    1706.95 |         12 |\n",
      "2024103100000013  |     424.34 |          2 |\n",
      "2024103100000014  |      89.74 |          1 |\n",
      "2024103100000015  |     454.08 |          3 |\n",
      "2024103101000016  |     101.95 |          1 |\n",
      "2024103101000017  |     170.63 |          1 |\n",
      "2024103100000018  |     144.93 |          1 |\n",
      "2024103101000019  |     451.45 |          3 |\n",
      "2024103101000020  |     272.83 |          2 |\n",
      "2024103100000021  |     517.69 |          3 |\n",
      "2024103100000022  |     405.87 |          3 |\n",
      "2024103100000023  |     101.16 |          1 |\n"
     ]
    }
   ],
   "source": [
    "#（5）使用SQL语句查询order表中每笔订单的总金额；\n",
    "read_sql(\"\"\"SELECT id,ROUND(SUM(total_price),2) AS tprice,SUM(num) AS total_num FROM orders GROUP BY id \"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "server      |tp          |ts          |\n",
      "---------------------------------\n",
      "B           |   89339.39 |        584 |\n",
      "C           |   89217.87 |        579 |\n",
      "D           |   81669.15 |        543 |\n",
      "A           |   77717.45 |        520 |\n",
      "E           |   76779.25 |        505 |\n",
      "F           |   66487.77 |        444 |\n"
     ]
    }
   ],
   "source": [
    "# （6）使用SQL语句查询order表中销售总价最高的服务员的信息；\n",
    "read_sql(\"\"\"SELECT \n",
    "                server,\n",
    "                ROUND(SUM(total_price),2) AS tp,\n",
    "                SUM(num) AS ts\n",
    "            FROM orders\n",
    "            GROUP BY server\n",
    "            ORDER BY SUM(total_price) DESC\n",
    "            LIMIT 10\n",
    "         \"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [],
   "source": [
    "# （7）在数据库supermarket中建立一个表stock存储月初的库存，包含以下字段，读取Demo_2.txt 中的数据，将数据插入到表stock中；\n",
    "read_sql(\"\"\"CREATE TABLE IF NOT EXISTS stock(\n",
    "            sku varchar(15),\n",
    "            kind varchar(15),\n",
    "            num int,\n",
    "            cost float,\n",
    "            price float\n",
    "         )\"\"\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[{'COUNT(*)': 640}]\n"
     ]
    }
   ],
   "source": [
    "with open(\"./Demo_2.txt\") as f:\n",
    "    temp = f.readlines()\n",
    "sqls = []\n",
    "for line in temp:\n",
    "    line = line.strip().split(\" \")\n",
    "    if len(line)!=5:\n",
    "        print(line)\n",
    "        continue\n",
    "    line[-3] = int(line[-3])\n",
    "    line[-2] = float(line[-2])\n",
    "    line[-1] = float(line[-1])\n",
    "    ss = f\"INSERT INTO stock(sku,kind,num,cost,price)VALUES('{line[0]}','{line[1]}',{line[2]},{line[3]},{line[4]});\"\n",
    "    sqls.append(ss)\n",
    "cursor = db.cursor()\n",
    "for sql in sqls:\n",
    "    cursor.execute(sql)\n",
    "read_sql(\"\"\"SELECT COUNT(*) FROM stock\"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[{'COUNT(*)': 320}]\n"
     ]
    }
   ],
   "source": [
    "# （8）使用SQL语句查询本月每个商品的销售数量；\n",
    "read_sql(\"\"\"\n",
    "SELECT COUNT(*) FROM(\n",
    "SELECT \n",
    "    sku,\n",
    "    SUM(num) AS ts\n",
    "FROM orders\n",
    "GROUP BY sku) a\n",
    "\"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[{'COUNT(*)': 640}]\n"
     ]
    }
   ],
   "source": [
    "# (9) 使用SQL语句查询每个商品在月末的库存；\n",
    "read_sql(\"\"\"\n",
    "SELECT COUNT(*) FROM(\n",
    "SELECT stock.*,a.ts,stock.num - a.ts AS last_stock\n",
    "FROM stock\n",
    "RIGHT JOIN(\n",
    "SELECT \n",
    "    sku,\n",
    "    SUM(num) AS ts\n",
    "FROM orders\n",
    "GROUP BY sku) a\n",
    "ON stock.sku = a.sku\n",
    "ORDER BY stock.num - a.ts ) s\n",
    "\"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "kind        |knum        |kts         |sale_rate   |\n",
      "---------------------------------\n",
      "0010102     |        452 |        274 |      0.606 |\n",
      "0010116     |        568 |        314 |      0.553 |\n",
      "0010112     |       1014 |        554 |      0.546 |\n",
      "0010106     |        908 |        490 |      0.540 |\n",
      "0010103     |        562 |        300 |      0.534 |\n",
      "0010114     |        798 |        422 |      0.529 |\n",
      "0010110     |        750 |        394 |      0.525 |\n",
      "0010107     |        790 |        402 |      0.509 |\n",
      "0010104     |        720 |        354 |      0.492 |\n",
      "0010101     |        246 |        118 |      0.480 |\n",
      "0010109     |        744 |        348 |      0.468 |\n",
      "0010113     |        972 |        448 |      0.461 |\n",
      "0010117     |        424 |        190 |      0.448 |\n",
      "0010108     |        596 |        264 |      0.443 |\n",
      "0010118     |        460 |        202 |      0.439 |\n",
      "0010111     |       1130 |        490 |      0.434 |\n",
      "0010115     |        768 |        330 |      0.430 |\n",
      "0010105     |        920 |        386 |      0.420 |\n",
      "0010119     |        168 |         70 |      0.417 |\n"
     ]
    }
   ],
   "source": [
    "# （10）使用SQL语句查询每个品类销售量占期初库存的比例，按照降序进行输出；\n",
    "read_sql(\"\"\"\n",
    "SELECT kind ,SUM(num) AS knum,SUM(ts) AS kts,ROUND(SUM(ts) / SUM(num),3) AS sale_rate\n",
    "FROM (\n",
    "SELECT stock.*,a.ts\n",
    "FROM stock\n",
    "RIGHT JOIN(\n",
    "SELECT \n",
    "    sku,\n",
    "    SUM(num) AS ts\n",
    "FROM orders\n",
    "GROUP BY sku) a\n",
    "ON stock.sku = a.sku\n",
    ") b\n",
    "GROUP BY kind\n",
    "ORDER BY SUM(ts) / SUM(num) DESC\n",
    "\"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "stime       |SUM(total_price)  |SUM(tprofit) |\n",
      "---------------------------------\n",
      "2024-10-17  |26224.830101013184 |    10993.5 |\n",
      "2024-10-26  |26049.209983825684 |   10634.43 |\n",
      "2024-10-12  |24758.790008544922 |   10796.93 |\n"
     ]
    }
   ],
   "source": [
    "# （11）哪天的销售额最高，当天销售的利润是多少；\n",
    "read_sql(\"\"\"\n",
    "-- SELECT COUNT(*) FROM(\n",
    "SELECT stime,SUM(total_price),SUM(tprofit) FROM (\n",
    "SELECT orders.*,a.cost,ROUND(orders.num * (orders.unit_price - a.cost),2) AS tprofit\n",
    "FROM orders\n",
    "RIGHT JOIN (SELECT sku,cost FROM stock GROUP BY sku,cost) a\n",
    "ON orders.sku = a.sku) b\n",
    "GROUP BY stime \n",
    "ORDER BY SUM(total_price) DESC \n",
    "LIMIT 3\n",
    "-- ) b\n",
    "         \"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "sku         |sn          |sp                |avgP        |price       |discount    |\n",
      "---------------------------------\n",
      "10506538    |          9 |788.8699951171875 |      87.65 |     117.74 |       0.74 |\n",
      "10587067    |          5 |612.1800079345703 |     122.44 |      161.1 |       0.76 |\n",
      "10501300    |         18 |2062.2700119018555 |     114.57 |     146.26 |       0.78 |\n",
      "10568781    |         13 |1236.4400100708008 |      95.11 |     121.22 |       0.78 |\n",
      "10508264    |          8 |1393.6999969482422 |     174.21 |     221.22 |       0.79 |\n",
      "10606245    |         10 |1508.7300109863281 |     150.87 |     190.98 |       0.79 |\n",
      "10517482    |         11 |2155.689956665039 |     195.97 |     247.78 |       0.79 |\n",
      "10591938    |         16 |1832.6100234985352 |     114.54 |      144.3 |       0.79 |\n",
      "10595686    |          8 |1053.9000091552734 |     131.74 |     164.67 |        0.8 |\n",
      "10598229    |          4 |491.2899932861328 |     122.82 |     153.53 |        0.8 |\n"
     ]
    }
   ],
   "source": [
    "# （12）查询本月所售商品中，折扣力度最大的商品货号；\n",
    "read_sql(\"\"\"\n",
    "-- SELECT COUNT(*) FROM(\n",
    "SELECT b.*,a.price,ROUND(b.avgP / a.price,2) AS discount FROM (\n",
    "SELECT sku,SUM(num) AS sn,SUM(total_price) AS sp ,ROUND(SUM(total_price) / SUM(num),2) AS avgP\n",
    "FROM orders\n",
    "GROUP BY sku\n",
    "         ) b\n",
    "RIGHT JOIN (SELECT sku,price FROM stock GROUP BY sku,price) a\n",
    "ON b.sku = a.sku\n",
    "ORDER BY discount\n",
    "LIMIT 10\n",
    "-- ) b\n",
    "         \"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "sku         |sn          |\n",
      "---------------------------------\n",
      "10508943    |          1 |\n",
      "10510612    |          1 |\n",
      "10524472    |          1 |\n",
      "10535114    |          1 |\n",
      "10535424    |          1 |\n",
      "10536684    |          1 |\n",
      "10538966    |          1 |\n",
      "10554968    |          1 |\n",
      "10555883    |          1 |\n",
      "10556192    |          1 |\n",
      "10558538    |          1 |\n",
      "10563143    |          1 |\n",
      "10566882    |          1 |\n",
      "10570482    |          1 |\n",
      "10570752    |          1 |\n",
      "10573492    |          1 |\n",
      "10574070    |          1 |\n",
      "10575804    |          1 |\n",
      "10577773    |          1 |\n",
      "10580013    |          1 |\n",
      "10595686    |          1 |\n",
      "10603915    |          1 |\n",
      "10604607    |          1 |\n",
      "10508943    |          1 |\n",
      "10510612    |          1 |\n",
      "10524472    |          1 |\n",
      "10535114    |          1 |\n",
      "10535424    |          1 |\n",
      "10536684    |          1 |\n",
      "10538966    |          1 |\n",
      "10554968    |          1 |\n",
      "10555883    |          1 |\n",
      "10556192    |          1 |\n",
      "10558538    |          1 |\n",
      "10563143    |          1 |\n",
      "10566882    |          1 |\n",
      "10570482    |          1 |\n",
      "10570752    |          1 |\n",
      "10573492    |          1 |\n",
      "10574070    |          1 |\n",
      "10575804    |          1 |\n",
      "10577773    |          1 |\n",
      "10580013    |          1 |\n",
      "10595686    |          1 |\n",
      "10603915    |          1 |\n",
      "10604607    |          1 |\n"
     ]
    }
   ],
   "source": [
    "# （13）本月前半月销售量最低的商品有哪些；\n",
    "read_sql(\"\"\"\n",
    "SELECT stock.sku,b.sn\n",
    "FROM stock \n",
    "RIGHT JOIN(\n",
    "SELECT sku,SUM(num) AS sn\n",
    "FROM (\n",
    "SELECT *,RIGHT(stime,2)+0 AS day\n",
    "FROM orders\n",
    "WHERE RIGHT(stime,2)+0 < 16) a\n",
    "GROUP BY sku\n",
    "ORDER BY sn\n",
    "         ) b\n",
    "ON stock.sku = b.sku\n",
    "WHERE sn = 1\n",
    "         \"\"\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
